<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Salil Chalise">
<meta name="dcterms.date" content="2025-04-27">

<title>Homework 8 - World Bank Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap-957abf0e8301ce287560cc8674794d32.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#problem-background" id="toc-problem-background" class="nav-link active" data-scroll-target="#problem-background">Problem Background</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
  <li><a href="#task-1" id="toc-task-1" class="nav-link" data-scroll-target="#task-1">Task 1</a></li>
  <li><a href="#task-2" id="toc-task-2" class="nav-link" data-scroll-target="#task-2">Task 2</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Homework 8 - World Bank Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Salil Chalise <a href="mailto:chalises2@vcu.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 27, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>GITHUB URL: <a href="https://github.com/cmsc-vcu/cmsc408-sp2025-hw8-chalises2" class="uri">https://github.com/cmsc-vcu/cmsc408-sp2025-hw8-chalises2</a></p>
<section id="problem-background" class="level1">
<h1>Problem Background</h1>
<div id="121faf78" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> helpers <span class="im">import</span> create_database_engine, run_sql_and_return_df, run_sql_and_return_html, create_db_wrapper, execute_ddl_from_file, execute_ddl</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load these variables from .env file.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>config_map <span class="op">=</span> {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'user'</span>: <span class="st">"CMSC408_HW8_USER"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'password'</span>: <span class="st">"CMSC408_HW8_PASSWORD"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'host'</span>: <span class="st">"CMSC408_HW8_HOST"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'database'</span>: <span class="st">"CMSC408_HW8_DB_NAME"</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>cnx,config <span class="op">=</span> create_db_wrapper( config_map )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="103a2021" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Do a quick test of the connection and trap the errors better!</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="st">select</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="st">  table_schema, table_name, table_rows</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="st">from</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">  information_schema.tables</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="st">where</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">  table_schema in ('world_bank_data')</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
TABLE_SCHEMA
</th>

<th>
TABLE_NAME
</th>

<th>
TABLE_ROWS
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
world_bank_data
</td>

<td>
wdi_country
</td>

<td>
265
</td>

</tr>

<tr>

<td>
world_bank_data
</td>

<td>
wdi_data
</td>

<td>
369046
</td>

</tr>

<tr>

<td>
world_bank_data
</td>

<td>
wdi_series
</td>

<td>
1395
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 3, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="exercises" class="level1">
<h1>Exercises</h1>
<p>In the following exercises, write the SQL as requested to discover the answer.</p>
<section id="task-1" class="level2">
<h2 class="anchored" data-anchor-id="task-1">Task 1</h2>
<p>How many records are in the country table?</p>
<div id="01406c4b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many records are in the world_bank_data.wdi_country table?</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (skills: select, aggregate)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="st">select</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">  count(*) as "Row Count"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">from</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Row Count
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
265
</td>

</tr>

<tr>
<td colspan="1" style="text-align: left;">
Total Rows: 1, Total Columns: 1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-2" class="level2">
<h2 class="anchored" data-anchor-id="task-2">Task 2</h2>
<p>Explore the first 5 records in the country table.</p>
<div id="2edbccfb" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">## write out the first 10 records and look at the columns</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Do you see any blanks or missing data?</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, limit)</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="st">select</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="st">  *</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="st">from </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="st">  world_bank_data.wdi_country</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="st">limit 10</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Country Code
</th>

<th>
Short Name
</th>

<th>
Table Name
</th>

<th>
Long Name
</th>

<th>
2-alpha code
</th>

<th>
Currency Unit
</th>

<th>
Special Notes
</th>

<th>
Region
</th>

<th>
Income Group
</th>

<th>
WB-2 code
</th>

<th>
National accounts base year
</th>

<th>
National accounts reference year
</th>

<th>
SNA price valuation
</th>

<th>
Lending category
</th>

<th>
Other groups
</th>

<th>
System of National Accounts
</th>

<th>
Alternative conversion factor
</th>

<th>
PPP survey year
</th>

<th>
Balance of Payments Manual in use
</th>

<th>
External debt Reporting status
</th>

<th>
System of trade
</th>

<th>
Government Accounting concept
</th>

<th>
IMF data dissemination standard
</th>

<th>
Latest population census
</th>

<th>
Latest household survey
</th>

<th>
Source of most recent Income and expenditure data
</th>

<th>
Vital registration complete
</th>

<th>
Latest agricultural census
</th>

<th>
Latest industrial data
</th>

<th>
Latest trade data
</th>

<th>
Latest water withdrawal data
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
ABW
</td>

<td>
Aruba
</td>

<td>
Aruba
</td>

<td>
Aruba
</td>

<td>
AW
</td>

<td>
Aruban florin
</td>

<td>
NULL
</td>

<td>
Latin America &amp; Caribbean
</td>

<td>
High income
</td>

<td>
AW
</td>

<td>
2013
</td>

<td>
NULL
</td>

<td>
Value added at basic prices (VAB)
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
Country uses the 1993 System of National Accounts methodology
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
BPM6
</td>

<td>
NULL
</td>

<td>
General trade system
</td>

<td>
NULL
</td>

<td>
Enhanced General Data Dissemination System (e-GDDS)
</td>

<td>
2020 (expected)
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
Yes
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
2018.0
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
AFE
</td>

<td>
Africa Eastern and Southern
</td>

<td>
Africa Eastern and Southern
</td>

<td>
Africa Eastern and Southern
</td>

<td>
ZH
</td>

<td>
NULL
</td>

<td>
26 countries, stretching from the Red Sea in the North to the Cape of Good Hope in the South (https://www.worldbank.org/en/region/afr/eastern-and-southern-africa)
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
ZH
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
AFG
</td>

<td>
Afghanistan
</td>

<td>
Afghanistan
</td>

<td>
Islamic State of Afghanistan
</td>

<td>
AF
</td>

<td>
Afghan afghani
</td>

<td>
The reporting period for national accounts data is designated as either calendar year basis (CY) or fiscal year basis (FY). For this country, it is fiscal year-based (fiscal year-end: March 20). Also, an estimate (PA.NUS.ATLS) of the exchange rate covers the same period and thus differs from the official exchange rate (CY).\n\nIn addition, the World Bank systematically assesses the appropriateness of official exchange rates as conversion factors. In this country, multiple or dual exchange rate activity exists and must be accounted for appropriately in underlying statistics. An alternative estimate (“alternative conversion factor” - PA.NUS.ATLS) is thus calculated as a weighted average of the different exchange rates in use in the country. Doing so better reflects economic reality and leads to more accurate cross-country comparisons and country classifications by income level. For this country, this applies to the period 1960-2006. Alternative conversion factors are used in the Atlas methodology and elsewhere in World Development Indicators as single-year conversion factors.
</td>

<td>
South Asia
</td>

<td>
Low income
</td>

<td>
AF
</td>

<td>
2016
</td>

<td>
NULL
</td>

<td>
Value added at basic prices (VAB)
</td>

<td>
IDA
</td>

<td>
HIPC
</td>

<td>
Country uses the 2008 System of National Accounts methodology
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
BPM6
</td>

<td>
Estimate
</td>

<td>
General trade system
</td>

<td>
Consolidated central government
</td>

<td>
Enhanced General Data Dissemination System (e-GDDS)
</td>

<td>
1979
</td>

<td>
Demographic and Health Survey, 2015
</td>

<td>
Integrated household survey (IHS), 2016/17
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
2018.0
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
AFW
</td>

<td>
Africa Western and Central
</td>

<td>
Africa Western and Central
</td>

<td>
Africa Western and Central
</td>

<td>
ZI
</td>

<td>
NULL
</td>

<td>
22 countries, stretching from the westernmost point of Africa, across the equator, and partly along the Atlantic Ocean till the Republic of Congo in the South (https://www.worldbank.org/en/region/afr/western-and-central-africa)
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
ZI
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
AGO
</td>

<td>
Angola
</td>

<td>
Angola
</td>

<td>
People's Republic of Angola
</td>

<td>
AO
</td>

<td>
Angolan kwanza
</td>

<td>
The World Bank systematically assesses the appropriateness of official exchange rates as conversion factors. In this country, multiple or dual exchange rate activity exists and must be accounted for appropriately in underlying statistics. An alternative estimate (“alternative conversion factor” - PA.NUS.ATLS) is thus calculated as a weighted average of the different exchange rates in use in the country. Doing so better reflects economic reality and leads to more accurate cross-country comparisons and country classifications by income level. For this country, this applies to the period 1994-2023. Alternative conversion factors are used in the Atlas methodology and elsewhere in World Development Indicators as single-year conversion factors.
</td>

<td>
Sub-Saharan Africa
</td>

<td>
Lower middle income
</td>

<td>
AO
</td>

<td>
2002
</td>

<td>
NULL
</td>

<td>
Value added at basic prices (VAB)
</td>

<td>
IBRD
</td>

<td>
NULL
</td>

<td>
Country uses the 1993 System of National Accounts methodology
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
BPM6
</td>

<td>
Actual
</td>

<td>
General trade system
</td>

<td>
Budgetary central government
</td>

<td>
Enhanced General Data Dissemination System (e-GDDS)
</td>

<td>
2014
</td>

<td>
Demographic and Health Survey, 2015/16
</td>

<td>
Integrated household survey (IHS), 2008/09
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
2018.0
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
ALB
</td>

<td>
Albania
</td>

<td>
Albania
</td>

<td>
Republic of Albania
</td>

<td>
AL
</td>

<td>
Albanian lek
</td>

<td>
NULL
</td>

<td>
Europe &amp; Central Asia
</td>

<td>
Upper middle income
</td>

<td>
AL
</td>

<td>
Original chained constant price data are rescaled.
</td>

<td>
2010.0
</td>

<td>
Value added at basic prices (VAB)
</td>

<td>
IBRD
</td>

<td>
NULL
</td>

<td>
Country uses the 2008 System of National Accounts methodology
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
BPM6
</td>

<td>
Actual
</td>

<td>
Special trade system
</td>

<td>
Consolidated central government
</td>

<td>
Enhanced General Data Dissemination System (e-GDDS)
</td>

<td>
2020 (expected)
</td>

<td>
Demographic and Health Survey, 2017/18
</td>

<td>
Living Standards Measurement Study Survey (LSMS), 2012
</td>

<td>
Yes
</td>

<td>
2012
</td>

<td>
2013.0
</td>

<td>
2018.0
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
AND
</td>

<td>
Andorra
</td>

<td>
Andorra
</td>

<td>
Principality of Andorra
</td>

<td>
AD
</td>

<td>
Euro
</td>

<td>
NULL
</td>

<td>
Europe &amp; Central Asia
</td>

<td>
High income
</td>

<td>
AD
</td>

<td>
2010
</td>

<td>
NULL
</td>

<td>
Value added at basic prices (VAB)
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
Country uses the 1993 System of National Accounts methodology
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
General trade system
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
<ol start="2011" type="1">
<li>Population figures compiled from administrative registers.
</li></ol></td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
Yes
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
2018.0
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
ARB
</td>

<td>
Arab World
</td>

<td>
Arab World
</td>

<td>
Arab World
</td>

<td>
1A
</td>

<td>
NULL
</td>

<td>
Arab World aggregate. Arab World is composed of members of the League of Arab States.
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
1A
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
ARE
</td>

<td>
United Arab Emirates
</td>

<td>
United Arab Emirates
</td>

<td>
United Arab Emirates
</td>

<td>
AE
</td>

<td>
U.A.E. dirham
</td>

<td>
NULL
</td>

<td>
Middle East &amp; North Africa
</td>

<td>
High income
</td>

<td>
AE
</td>

<td>
2010
</td>

<td>
NULL
</td>

<td>
Value added at producer prices (VAP)
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
Country uses the 2008 System of National Accounts methodology
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
Special trade system
</td>

<td>
Consolidated central government
</td>

<td>
Enhanced General Data Dissemination System (e-GDDS)
</td>

<td>
2020 (expected)
</td>

<td>
World Health Survey, 2003
</td>

<td>
NULL
</td>

<td>
Yes
</td>

<td>
2012
</td>

<td>
1985.0
</td>

<td>
2018.0
</td>

<td>
NULL
</td>

</tr>

<tr>

<td>
ARG
</td>

<td>
Argentina
</td>

<td>
Argentina
</td>

<td>
Argentine Republic
</td>

<td>
AR
</td>

<td>
Argentine peso
</td>

<td>
The World Bank systematically assesses the appropriateness of official exchange rates as conversion factors. In this country, multiple or dual exchange rate activity exists and must be accounted for appropriately in underlying statistics. An alternative estimate (“alternative conversion factor” - PA.NUS.ATLS) is thus calculated as a weighted average of the different exchange rates in use in the country. Doing so better reflects economic reality and leads to more accurate cross-country comparisons and country classifications by income level. For this country, this applies to the period 1971-2018. Alternative conversion factors are used in the Atlas methodology and elsewhere in World Development Indicators as single-year conversion factors.
</td>

<td>
Latin America &amp; Caribbean
</td>

<td>
Upper middle income
</td>

<td>
AR
</td>

<td>
2004
</td>

<td>
NULL
</td>

<td>
Value added at basic prices (VAB)
</td>

<td>
IBRD
</td>

<td>
NULL
</td>

<td>
Country uses the 2008 System of National Accounts methodology
</td>

<td>
NULL
</td>

<td>
NULL
</td>

<td>
BPM6
</td>

<td>
Actual
</td>

<td>
Special trade system
</td>

<td>
Consolidated central government
</td>

<td>
Special Data Dissemination Standard (SDDS)
</td>

<td>
2020 (expected)
</td>

<td>
Multiple Indicator Cluster Survey, 2019/20
</td>

<td>
Integrated household survey (IHS), 2016
</td>

<td>
Yes
</td>

<td>
2008
</td>

<td>
2002.0
</td>

<td>
2018.0
</td>

<td>
NULL
</td>

</tr>

<tr>
<td colspan="31" style="text-align: left;">
Total Rows: 10, Total Columns: 31
</td>
</tr>
</tbody>

</table>

<p>:::</p>
<p>:::</p>
<section id="task-3" class="level2">
<h2 class="anchored" data-anchor-id="task-3">Task 3</h2>
<p>List all non-countries.</p>
<div id="aebee2bf" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">## task 3</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">## Which records are NOT for countries, that is they're for regions or groups of countries.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">## How can you tell?</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Once you figure it out, write a query to list all the non-countries</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT `Short Name` AS country</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">FROM world_bank_data.wdi_country</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `Region` IS NULL </span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="st">   OR `Region` = '';</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
country
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Africa Eastern and Southern
</td>

</tr>

<tr>

<td>
Africa Western and Central
</td>

</tr>

<tr>

<td>
Arab World
</td>

</tr>

<tr>

<td>
Central Europe and the Baltics
</td>

</tr>

<tr>

<td>
Caribbean small states
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific (excluding high income)
</td>

</tr>

<tr>

<td>
Early-demographic dividend
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia (excluding high income)
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

</tr>

<tr>

<td>
Euro area
</td>

</tr>

<tr>

<td>
European Union
</td>

</tr>

<tr>

<td>
Fragile and conflict affected situations
</td>

</tr>

<tr>

<td>
High income
</td>

</tr>

<tr>

<td>
Heavily indebted poor countries (HIPC)
</td>

</tr>

<tr>

<td>
IBRD only
</td>

</tr>

<tr>

<td>
IDA &amp; IBRD total
</td>

</tr>

<tr>

<td>
IDA total
</td>

</tr>

<tr>

<td>
IDA blend
</td>

</tr>

<tr>

<td>
IDA only
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean (excluding high income)
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

</tr>

<tr>

<td>
Least developed countries: UN classification
</td>

</tr>

<tr>

<td>
Low income
</td>

</tr>

<tr>

<td>
Lower middle income
</td>

</tr>

<tr>

<td>
Low &amp; middle income
</td>

</tr>

<tr>

<td>
Late-demographic dividend
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

</tr>

<tr>

<td>
Middle income
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa (excluding high income)
</td>

</tr>

<tr>

<td>
North America
</td>

</tr>

<tr>

<td>
OECD members
</td>

</tr>

<tr>

<td>
Other small states
</td>

</tr>

<tr>

<td>
Pre-demographic dividend
</td>

</tr>

<tr>

<td>
Pacific island small states
</td>

</tr>

<tr>

<td>
Post-demographic dividend
</td>

</tr>

<tr>

<td>
South Asia
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa (excluding high income)
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

</tr>

<tr>

<td>
Small states
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
South Asia (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa (IDA &amp; IBRD)
</td>

</tr>

<tr>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
World
</td>

</tr>

<tr>
<td colspan="1" style="text-align: left;">
Total Rows: 48, Total Columns: 1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-4" class="level2">
<h2 class="anchored" data-anchor-id="task-4">Task 4</h2>
<p>Create your own copy of WDI_Country containing just countries.</p>
<div id="06a09ad1" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">## task 4</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">## The WDI table clearly contains information for countries and non-countries</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">## using CREATE TABLE ... SELECT from WHERE syntax.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">## Finally, below write a query to return the number</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">## of records in the new table.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># drop table</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>execute_ddl(cnx,<span class="st">"""</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="st">DROP TABLE IF EXISTS wdi_country;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ed330f82" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create table</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>execute_ddl(cnx,<span class="st">"""</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="st">CREATE TABLE wdi_country AS</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT *</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM world_bank_data.wdi_country</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `Region` IS NOT NULL AND `Region` != '';</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="68ec18b8" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show number of records</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT COUNT(*) AS "Number of Countries"</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Number of Countries
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
217
</td>

</tr>

<tr>
<td colspan="1" style="text-align: left;">
Total Rows: 1, Total Columns: 1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-5" class="level2">
<h2 class="anchored" data-anchor-id="task-5">Task 5</h2>
<p>According to the World Bank, in 2020 there were how many countries in the world?</p>
<div id="1fb008dd" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT COUNT(*) AS "Countries in 2020"</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `Region` IS NOT NULL </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="st">  AND `Region` != '';</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Countries in 2020
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
217
</td>

</tr>

<tr>
<td colspan="1" style="text-align: left;">
Total Rows: 1, Total Columns: 1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-6" class="level2">
<h2 class="anchored" data-anchor-id="task-6">Task 6</h2>
<p>What are all unique values of region in the wdi_country table?</p>
<div id="daf2b043" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Let's investigate the country_region field.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">## What is the domain of the country_region field? That is,</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">## what are the unique values found there?</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">## (there are several possible ways to code this in SQL)</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, order by)</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT `Region`</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY `Region`;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
East Asia &amp; Pacific
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

</tr>

<tr>

<td>
North America
</td>

</tr>

<tr>

<td>
South Asia
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

</tr>

<tr>
<td colspan="1" style="text-align: left;">
Total Rows: 7, Total Columns: 1
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-7" class="level2">
<h2 class="anchored" data-anchor-id="task-7">Task 7</h2>
<p>How many countries are in each region?</p>
<div id="b870be56" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">## How many countries are in each region?</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, group by, order by)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT `Region`, COUNT(*) AS `Number of Countries`</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY `Region`</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY `Region`;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
Number of Countries
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
37
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
58
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
42
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
21
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
3
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
8
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
48
</td>

</tr>

<tr>
<td colspan="2" style="text-align: left;">
Total Rows: 7, Total Columns: 2
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-8" class="level2">
<h2 class="anchored" data-anchor-id="task-8">Task 8</h2>
<p>List the country full names and regions for all countries in north america.</p>
<div id="20b76b0b" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">## List the country full names and regions for all countries in north america</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where, order by)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT `Long Name`, `Region`</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `Region` = 'North America'</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY `Long Name`;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Long Name
</th>

<th>
Region
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Canada
</td>

<td>
North America
</td>

</tr>

<tr>

<td>
The Bermudas
</td>

<td>
North America
</td>

</tr>

<tr>

<td>
United States of America
</td>

<td>
North America
</td>

</tr>

<tr>
<td colspan="2" style="text-align: left;">
Total Rows: 3, Total Columns: 2
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-9" class="level2">
<h2 class="anchored" data-anchor-id="task-9">Task 9</h2>
<div id="a3adec7c" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">## The last World Cup soccer tournament was hosted by Qatar.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">## What region contains Qatar?  List the region, country short name and full name</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT `Region`, `Short Name`, `Long Name`</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `Short Name` = 'Qatar';</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
Short Name
</th>

<th>
Long Name
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Qatar
</td>

<td>
State of Qatar
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 1, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-10" class="level2">
<h2 class="anchored" data-anchor-id="task-10">Task 10</h2>
<div id="b651e8e0" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">## There are two abbreviation fields in the data country_abbr and country_wb_abbr.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">## List the country code, short name, abbr, wb_abbr and region for all the countries</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">## where the abbr and wb_abbr are different.</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where, order by)</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT `Country Code`, `Short Name`, `2-alpha code`, `WB-2 code`, `Region`</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `2-alpha code` IS NOT NULL</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="st">  AND `WB-2 code` IS NOT NULL</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="st">  AND `2-alpha code` != `WB-2 code`</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY `Short Name`;</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Country Code
</th>

<th>
Short Name
</th>

<th>
2-alpha code
</th>

<th>
WB-2 code
</th>

<th>
Region
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
COD
</td>

<td>
Dem. Rep.&nbsp;Congo
</td>

<td>
CD
</td>

<td>
ZR
</td>

<td>
Sub-Saharan Africa
</td>

</tr>

<tr>

<td>
SRB
</td>

<td>
Serbia
</td>

<td>
RS
</td>

<td>
YF
</td>

<td>
Europe &amp; Central Asia
</td>

</tr>

<tr>

<td>
TLS
</td>

<td>
Timor-Leste
</td>

<td>
TL
</td>

<td>
TP
</td>

<td>
East Asia &amp; Pacific
</td>

</tr>

<tr>

<td>
PSE
</td>

<td>
West Bank and Gaza
</td>

<td>
PS
</td>

<td>
GZ
</td>

<td>
Middle East &amp; North Africa
</td>

</tr>

<tr>

<td>
YEM
</td>

<td>
Yemen
</td>

<td>
YE
</td>

<td>
RY
</td>

<td>
Middle East &amp; North Africa
</td>

</tr>

<tr>
<td colspan="5" style="text-align: left;">
Total Rows: 5, Total Columns: 5
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-11" class="level2">
<h2 class="anchored" data-anchor-id="task-11">Task 11</h2>
<div id="7ccc4f76" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Now, let's investigate the "income category" field.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">## List the income categories and the number of countries in each</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">## income category in descending order of most countries to least.</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, group by, order by)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT `Income Group`, COUNT(*) AS `Number of Countries`</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY `Income Group`</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY `Number of Countries` DESC;</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Income Group
</th>

<th>
Number of Countries
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
High income
</td>

<td>
85
</td>

</tr>

<tr>

<td>
Upper middle income
</td>

<td>
54
</td>

</tr>

<tr>

<td>
Lower middle income
</td>

<td>
51
</td>

</tr>

<tr>

<td>
Low income
</td>

<td>
26
</td>

</tr>

<tr>

<td>
NULL
</td>

<td>
1
</td>

</tr>

<tr>
<td colspan="2" style="text-align: left;">
Total Rows: 5, Total Columns: 2
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-12" class="level2">
<h2 class="anchored" data-anchor-id="task-12">Task 12</h2>
<div id="8758cf92" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Mystery task.  Looking at the table from Task 11 (anything odd?) write the</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">## next obvious query based on the results in the table.</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">## At a minimum, your query should put country short name in the first column.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">## you will be scored on the number of records returned and the value(s) </span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">## in the first column.</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT `Short Name`, `Country Code`, `Region`</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `Income Group` IS NULL</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY `Short Name`;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Short Name
</th>

<th>
Country Code
</th>

<th>
Region
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Venezuela
</td>

<td>
VEN
</td>

<td>
Latin America &amp; Caribbean
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 1, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-13" class="level2">
<h2 class="anchored" data-anchor-id="task-13">Task 13</h2>
<div id="39339928" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">## OK, this HAS to be an error. Let's make a assumption that the country </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">## in question, because they are oil-rich, are "high income".  </span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">## Write an update comment to correct the issue.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">## </span><span class="al">NOTE</span><span class="co"> - if you get this wrong, all subsequent tables will be wrong!</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>execute_ddl(cnx,<span class="st">"""</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="st">UPDATE wdi_country</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="st">SET `Income Group` = 'High income'</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `Short Name` = 'Venezuela';</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="st">COMMIT;</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="56b54193" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Now, display the country again to verify the change stuck!</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT `Short Name`, `Income Group`, `Region`</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `Short Name` = 'Venezuela';</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Short Name
</th>

<th>
Income Group
</th>

<th>
Region
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Venezuela
</td>

<td>
High income
</td>

<td>
Latin America &amp; Caribbean
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 1, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-14" class="level2">
<h2 class="anchored" data-anchor-id="task-14">Task 14</h2>
<div id="f0d04b3b" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Write a single query that show the number of countries in each </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">## "Region"-"Income Group" pair.  The table should have 3 columns:</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co">## region, income group, and no.of.countries.</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, group by, order by)</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="st">  `Region`,</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="st">  COALESCE(`Income Group`, 'Other') AS `Income Group`,</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="st">  COUNT(*) AS `Number of Countries`</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY `Region`, `Income Group`</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY `Region`, `Income Group`;</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
Income Group
</th>

<th>
Number of Countries
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
High income
</td>

<td>
15
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
Low income
</td>

<td>
1
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
Lower middle income
</td>

<td>
12
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

<td>
9
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
High income
</td>

<td>
40
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
Lower middle income
</td>

<td>
3
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
Upper middle income
</td>

<td>
15
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
High income
</td>

<td>
19
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
Lower middle income
</td>

<td>
4
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
Upper middle income
</td>

<td>
19
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
High income
</td>

<td>
8
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Low income
</td>

<td>
2
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Lower middle income
</td>

<td>
7
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Upper middle income
</td>

<td>
4
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
High income
</td>

<td>
3
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
Low income
</td>

<td>
1
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
Lower middle income
</td>

<td>
6
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
Upper middle income
</td>

<td>
1
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
High income
</td>

<td>
1
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
Low income
</td>

<td>
22
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
Lower middle income
</td>

<td>
19
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
Upper middle income
</td>

<td>
6
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 22, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-15" class="level2">
<h2 class="anchored" data-anchor-id="task-15">Task 15</h2>
<div id="aebffe80" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Examine the result from task 14. It would be really cool to</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">## present the results of this table in a 2-D form, with </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">## columns for each income category (high, upper middle, lower middle, low, other)</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">## regions down the side, and the pair-wise count inside each cell.</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Using CASE statements, DO IT!  BE SURE to include the countries without</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">## an income category.</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">## HINT - your query should return 6 columns: the region name, one</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">## column for each of the income categories (e.g., High, Upper middle, etc.)</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">## and a column for the row totals.</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, group by, nested query)</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="st">  Region,</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="st">  SUM(CASE WHEN `Income Group` = 'High income' THEN 1 ELSE 0 END) AS `High income`,</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="st">  SUM(CASE WHEN `Income Group` = 'Upper middle income' THEN 1 ELSE 0 END) AS `Upper middle income`,</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="st">  SUM(CASE WHEN `Income Group` = 'Lower middle income' THEN 1 ELSE 0 END) AS `Lower middle income`,</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="st">  SUM(CASE WHEN `Income Group` = 'Low income' THEN 1 ELSE 0 END) AS `Low income`,</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="st">  CAST(COUNT(*) AS DECIMAL(10,1)) AS `Total`</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY Region</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY Region;</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
High income
</th>

<th>
Upper middle income
</th>

<th>
Lower middle income
</th>

<th>
Low income
</th>

<th>
Total
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
15.0
</td>

<td>
9.0
</td>

<td>
12.0
</td>

<td>
1.0
</td>

<td>
37.0
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
40.0
</td>

<td>
15.0
</td>

<td>
3.0
</td>

<td>
0.0
</td>

<td>
58.0
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
19.0
</td>

<td>
19.0
</td>

<td>
4.0
</td>

<td>
0.0
</td>

<td>
42.0
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
8.0
</td>

<td>
4.0
</td>

<td>
7.0
</td>

<td>
2.0
</td>

<td>
21.0
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
3.0
</td>

<td>
0.0
</td>

<td>
0.0
</td>

<td>
0.0
</td>

<td>
3.0
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
0.0
</td>

<td>
1.0
</td>

<td>
6.0
</td>

<td>
1.0
</td>

<td>
8.0
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
1.0
</td>

<td>
6.0
</td>

<td>
19.0
</td>

<td>
22.0
</td>

<td>
48.0
</td>

</tr>

<tr>
<td colspan="6" style="text-align: left;">
Total Rows: 7, Total Columns: 6
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-16" class="level2">
<h2 class="anchored" data-anchor-id="task-16">Task 16</h2>
<div id="f1778b2c" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Wow! what a cool table!  It is very interesting to see where the money</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">## sits around the world.  Using the general approach from Task 14 above</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co">## and write a query to return the single region with the most lower-income</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">## countries.</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Your query should return 3 columns, the number of </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">## low-income countries, the region name and the income group</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">## PUT THE NUMBER FIRST! (use: count, region name, income group)</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, aggregate, group by, nested query, order by, limit)</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="st">  COUNT(*) AS `Number of Countries`,</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="st">  `Region`,</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `Income Group` = 'Low income'</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY `Region`, `Income Group`</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY `Number of Countries` DESC</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 1;</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Number of Countries
</th>

<th>
Region
</th>

<th>
Income Group
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
22
</td>

<td>
Sub-Saharan Africa
</td>

<td>
Low income
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 1, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-17" class="level2">
<h2 class="anchored" data-anchor-id="task-17">Task 17</h2>
<div id="bc5293ad" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Are you getting the hand of this? Good! We need to take a look at all</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">## the countries in the same region and with the same income category as</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">## the Marshall Islands.</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">## For each country that matches, print their country code, short name,</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">## region and income category, by order of their short name.  As a hint,</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">## the country code for the Marshall Islands is MHL.</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where, subquery)</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="st">  `Country Code`,</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="st">  `Short Name`,</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="st">  `Region`,</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE `Region` = (</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT `Region`</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM wdi_country</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="st">    WHERE `Country Code` = 'MHL'</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="st">AND `Income Group` = (</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT `Income Group`</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM wdi_country</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="st">    WHERE `Country Code` = 'MHL'</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY `Short Name`;</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Country Code
</th>

<th>
Short Name
</th>

<th>
Region
</th>

<th>
Income Group
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
CHN
</td>

<td>
China
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
FJI
</td>

<td>
Fiji
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
IDN
</td>

<td>
Indonesia
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
MYS
</td>

<td>
Malaysia
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
MHL
</td>

<td>
Marshall Islands
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
MNG
</td>

<td>
Mongolia
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
THA
</td>

<td>
Thailand
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
TON
</td>

<td>
Tonga
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>

<td>
TUV
</td>

<td>
Tuvalu
</td>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

</tr>

<tr>
<td colspan="4" style="text-align: left;">
Total Rows: 9, Total Columns: 4
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-18" class="level2">
<h2 class="anchored" data-anchor-id="task-18">Task 18</h2>
<div id="d4c0b4bd" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">## OK - let's raise the heat in the kitchen! Review the output from task 14.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">## You'll see that some of the regions do not contain all of the income</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">## levels.  For example, the Europe &amp; Central Asia region does not have</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">## any low income countries.</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">## CHALLENGE - using a SINGLE SQL statement, write a table that contains every</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">## combination of region and income category (including the missing '') values!</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">## THEN add a WHERE clause to only show the values that were missing from</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">## the original pairings!</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">## HINT - there should be AT MOST [# of regions]x[# of income cats] = 28</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">## rows in your final table, and there are 22 rows returned in the query</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">## in Task 14.  (FYI - I get 6 rows in my final table.)</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where, subqueries, joins)</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="st">WITH combos AS (</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT DISTINCT a.Region, b.`Income Group`</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM wdi_country a</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="st">  CROSS JOIN wdi_country b</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE a.Region IS NOT NULL AND b.`Income Group` IS NOT NULL</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="st">),</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="st">valid_pairs AS (</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT DISTINCT Region, `Income Group`</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM wdi_country</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE Region IS NOT NULL AND `Income Group` IS NOT NULL</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT c.Region, c.`Income Group`, 0 AS `Count`</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="st">FROM combos c</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="st">LEFT JOIN valid_pairs v</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="st">  ON c.Region = v.Region AND c.`Income Group` = v.`Income Group`</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE v.Region IS NULL</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY c.Region, c.`Income Group`;</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
Income Group
</th>

<th>
Count
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
Low income
</td>

<td>
0
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
Low income
</td>

<td>
0
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
Low income
</td>

<td>
0
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
Lower middle income
</td>

<td>
0
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
Upper middle income
</td>

<td>
0
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
High income
</td>

<td>
0
</td>

</tr>

<tr>
<td colspan="3" style="text-align: left;">
Total Rows: 6, Total Columns: 3
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-19" class="level2">
<h2 class="anchored" data-anchor-id="task-19">Task 19</h2>
<div id="510e11b8" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Hot enough, yet?  Let's go for ghost-pepper HOT!  Now let's build some</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">## percentage tables.  For example, across the entire sample, what</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">## is the percentage of total countries in each income category?</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">## As a first step, build off the result from task 14 and create a table with</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">## six columns (region, income cat, country count, sum of countries in region,</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">## sum of countries by income and total sum countries).</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co">## THEN, add a 7th column calculating the percent of total for each,</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">## region-income pair.</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">##</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">## actually calculating percentages and print out a table will be a</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co">## slam dunk after this!</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co">## (skills: select, where, subqueries, joins, aggregate functions)</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="st">WITH base AS (</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT </span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="st">        `Region`,</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="st">        `Income Group`,</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="st">        COUNT(*) AS country_count</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM wdi_country</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY `Region`, `Income Group`</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="st">),</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="st">region_totals AS (</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT </span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="st">        `Region`,</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a><span class="st">        SUM(country_count) AS region_total</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM base</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY `Region`</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="st">),</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="st">income_totals AS (</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT </span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="st">        `Income Group`,</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a><span class="st">        SUM(country_count) AS income_total</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM base</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY `Income Group`</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="st">),</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="st">grand_total AS (</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT </span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="st">        SUM(country_count) AS total_countries</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM base</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="st">    b.`Region`,</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="st">    b.`Income Group`,</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="st">    b.`country_count`,</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="st">    r.`region_total`,</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="st">    i.`income_total`,</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="st">    g.`total_countries`,</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="st">    ROUND((b.`country_count` / g.`total_countries`) * 100, 2) AS percent_of_total</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="st">FROM </span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="st">    base b</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN </span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="st">    region_totals r ON b.`Region` = r.`Region`</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN </span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="st">    income_totals i ON b.`Income Group` = i.`Income Group`</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a><span class="st">CROSS JOIN </span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="st">    grand_total g</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY </span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="st">    b.`Region`, b.`Income Group`;</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
Income Group
</th>

<th>
country_count
</th>

<th>
region_total
</th>

<th>
income_total
</th>

<th>
total_countries
</th>

<th>
percent_of_total
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
High income
</td>

<td>
15
</td>

<td>
37.0
</td>

<td>
86.0
</td>

<td>
217.0
</td>

<td>
6.91
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
Low income
</td>

<td>
1
</td>

<td>
37.0
</td>

<td>
26.0
</td>

<td>
217.0
</td>

<td>
0.46
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
Lower middle income
</td>

<td>
12
</td>

<td>
37.0
</td>

<td>
51.0
</td>

<td>
217.0
</td>

<td>
5.53
</td>

</tr>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
Upper middle income
</td>

<td>
9
</td>

<td>
37.0
</td>

<td>
54.0
</td>

<td>
217.0
</td>

<td>
4.15
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
High income
</td>

<td>
40
</td>

<td>
58.0
</td>

<td>
86.0
</td>

<td>
217.0
</td>

<td>
18.43
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
Lower middle income
</td>

<td>
3
</td>

<td>
58.0
</td>

<td>
51.0
</td>

<td>
217.0
</td>

<td>
1.38
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
Upper middle income
</td>

<td>
15
</td>

<td>
58.0
</td>

<td>
54.0
</td>

<td>
217.0
</td>

<td>
6.91
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
High income
</td>

<td>
19
</td>

<td>
42.0
</td>

<td>
86.0
</td>

<td>
217.0
</td>

<td>
8.76
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
Lower middle income
</td>

<td>
4
</td>

<td>
42.0
</td>

<td>
51.0
</td>

<td>
217.0
</td>

<td>
1.84
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
Upper middle income
</td>

<td>
19
</td>

<td>
42.0
</td>

<td>
54.0
</td>

<td>
217.0
</td>

<td>
8.76
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
High income
</td>

<td>
8
</td>

<td>
21.0
</td>

<td>
86.0
</td>

<td>
217.0
</td>

<td>
3.69
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Low income
</td>

<td>
2
</td>

<td>
21.0
</td>

<td>
26.0
</td>

<td>
217.0
</td>

<td>
0.92
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Lower middle income
</td>

<td>
7
</td>

<td>
21.0
</td>

<td>
51.0
</td>

<td>
217.0
</td>

<td>
3.23
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
Upper middle income
</td>

<td>
4
</td>

<td>
21.0
</td>

<td>
54.0
</td>

<td>
217.0
</td>

<td>
1.84
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
High income
</td>

<td>
3
</td>

<td>
3.0
</td>

<td>
86.0
</td>

<td>
217.0
</td>

<td>
1.38
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
Low income
</td>

<td>
1
</td>

<td>
8.0
</td>

<td>
26.0
</td>

<td>
217.0
</td>

<td>
0.46
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
Lower middle income
</td>

<td>
6
</td>

<td>
8.0
</td>

<td>
51.0
</td>

<td>
217.0
</td>

<td>
2.76
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
Upper middle income
</td>

<td>
1
</td>

<td>
8.0
</td>

<td>
54.0
</td>

<td>
217.0
</td>

<td>
0.46
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
High income
</td>

<td>
1
</td>

<td>
48.0
</td>

<td>
86.0
</td>

<td>
217.0
</td>

<td>
0.46
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
Low income
</td>

<td>
22
</td>

<td>
48.0
</td>

<td>
26.0
</td>

<td>
217.0
</td>

<td>
10.14
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
Lower middle income
</td>

<td>
19
</td>

<td>
48.0
</td>

<td>
51.0
</td>

<td>
217.0
</td>

<td>
8.76
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
Upper middle income
</td>

<td>
6
</td>

<td>
48.0
</td>

<td>
54.0
</td>

<td>
217.0
</td>

<td>
2.76
</td>

</tr>

<tr>
<td colspan="7" style="text-align: left;">
Total Rows: 22, Total Columns: 7
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-20" class="level2">
<h2 class="anchored" data-anchor-id="task-20">Task 20</h2>
<div id="0bb4c4e4" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">## SLAM DUNK TIME!  Using the resulting table CTEs from Task 19,</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">## print table similar to the table in Task 15, with Income group in the</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">## columns, Region in the rows and Percent of total in each cell of the table.</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Region,</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(100.0 * SUM(CASE WHEN `Income Group` = 'High income' THEN 1 ELSE 0 END) / COUNT(*), 1) AS `High income`,</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(100.0 * SUM(CASE WHEN `Income Group` = 'Upper middle income' THEN 1 ELSE 0 END) / COUNT(*), 1) AS `Upper middle income`,</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(100.0 * SUM(CASE WHEN `Income Group` = 'Lower middle income' THEN 1 ELSE 0 END) / COUNT(*), 1) AS `Lower middle income`,</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(100.0 * SUM(CASE WHEN `Income Group` = 'Low income' THEN 1 ELSE 0 END) / COUNT(*), 1) AS `Low income`,</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="st">  100.0 AS `Total`</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY Region</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY Region;</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Region
</th>

<th>
High income
</th>

<th>
Upper middle income
</th>

<th>
Lower middle income
</th>

<th>
Low income
</th>

<th>
Total
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
East Asia &amp; Pacific
</td>

<td>
40.5
</td>

<td>
24.3
</td>

<td>
32.4
</td>

<td>
2.7
</td>

<td>
100.0
</td>

</tr>

<tr>

<td>
Europe &amp; Central Asia
</td>

<td>
69.0
</td>

<td>
25.9
</td>

<td>
5.2
</td>

<td>
0.0
</td>

<td>
100.0
</td>

</tr>

<tr>

<td>
Latin America &amp; Caribbean
</td>

<td>
45.2
</td>

<td>
45.2
</td>

<td>
9.5
</td>

<td>
0.0
</td>

<td>
100.0
</td>

</tr>

<tr>

<td>
Middle East &amp; North Africa
</td>

<td>
38.1
</td>

<td>
19.0
</td>

<td>
33.3
</td>

<td>
9.5
</td>

<td>
100.0
</td>

</tr>

<tr>

<td>
North America
</td>

<td>
100.0
</td>

<td>
0.0
</td>

<td>
0.0
</td>

<td>
0.0
</td>

<td>
100.0
</td>

</tr>

<tr>

<td>
South Asia
</td>

<td>
0.0
</td>

<td>
12.5
</td>

<td>
75.0
</td>

<td>
12.5
</td>

<td>
100.0
</td>

</tr>

<tr>

<td>
Sub-Saharan Africa
</td>

<td>
2.1
</td>

<td>
12.5
</td>

<td>
39.6
</td>

<td>
45.8
</td>

<td>
100.0
</td>

</tr>

<tr>
<td colspan="6" style="text-align: left;">
Total Rows: 7, Total Columns: 6
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="task-21" class="level2">
<h2 class="anchored" data-anchor-id="task-21">Task 21</h2>
<div id="c15b0e04" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">## ANOTHER DUNK!  Using the resulting table CTEs from Task 19,</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">## print a table listing the number, totals and percentage of countries</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">## by income category.</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">## (This is much simpler than task 20!)</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>run_sql_and_return_html(cnx,<span class="st">"""</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="st">  `Income Group`,</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="st">  COUNT(*) AS count,</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="st">  (SELECT COUNT(*) FROM wdi_country) AS total,</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="st">  ROUND(100.0 * COUNT(*) / (SELECT COUNT(*) FROM wdi_country), 1) AS percentage</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="st">FROM wdi_country</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY `Income Group`</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="st">  CASE</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="st">    WHEN `Income Group` = 'High income' THEN 1</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="st">    WHEN `Income Group` = 'Upper middle income' THEN 2</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="st">    WHEN `Income Group` = 'Lower middle income' THEN 3</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="st">    WHEN `Income Group` = 'Low income' THEN 4</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="st">    ELSE 5</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="st">  END;</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<table class="dataframe table table-sm table-striped small">

<thead>

<tr>

<th>
Income Group
</th>

<th>
count
</th>

<th>
total
</th>

<th>
percentage
</th>

</tr>

</thead>

<tbody>

<tr>

<td>
High income
</td>

<td>
86
</td>

<td>
217
</td>

<td>
39.6
</td>

</tr>

<tr>

<td>
Upper middle income
</td>

<td>
54
</td>

<td>
217
</td>

<td>
24.9
</td>

</tr>

<tr>

<td>
Lower middle income
</td>

<td>
51
</td>

<td>
217
</td>

<td>
23.5
</td>

</tr>

<tr>

<td>
Low income
</td>

<td>
26
</td>

<td>
217
</td>

<td>
12.0
</td>

</tr>

<tr>
<td colspan="4" style="text-align: left;">
Total Rows: 4, Total Columns: 4
</td>
</tr>
</tbody>

</table>
</div>
</div>
</section>
<section id="reflection" class="level1">
<h1>Reflection</h1>
<ol type="1">
<li>Reflect on the SQL skills you used throughout these exercises. Which skills do you feel most confident in, and which do you think need more practice? How has this assignment helped you build or reinforce specific SQL competencies?</li>
</ol>
<p>I feel confident with basic queries like SELECT, WHERE, GROUP BY, and ORDER BY. I need a little more practice with CASE statements and using CTEs. This assignment helped me get better at building queries step-by-step and understanding how tables are connected.</p>
<ol start="2" type="1">
<li>Problem-Solving Approach: Describe your approach to tackling the more complex tasks (like Tasks 18, 23, and 24). How did you break down these problems, and what steps did you take when you encountered challenges? How would you approach a similar problem differently in the future?</li>
</ol>
<p>For harder tasks, I started by rereading the question slowly and picking out the main goal. I broke it down into small parts and tested simple queries first before trying bigger ones. If something didn’t work, I changed one thing at a time until it did. In the future, I’ll keep practicing that method but plan a little more before writing long queries.</p>
<ol start="3" type="1">
<li>Learning Takeaways: Consider the overall learning experience from this assignment. What were the biggest takeaways about working with SQL for data analysis and transformation? How do you think these skills will apply in real-world scenarios or future coursework?</li>
</ol>
<p>The biggest takeaway was realizing how important it is to think carefully about how data is related before writing SQL. I also saw how useful CTEs and JOINs are for organizing complicated data. These skills will definitely help in real-world projects where databases are bigger and messier.</p>
</section>
<section id="readme" class="level1">
<h1>README</h1>
<div style="background:lightgray; margin-left:20px; border-top: 3px solid black; border-bottom: 3px solid black; padding-left:20px; padding-right:20px">
<p>Homework 8 README</p>
<p>Overview</p>
<p>This project connects to a database and runs SQL queries to explore information from the World Bank.</p>
<p>Steps</p>
<p>Connected to the database using Python and Quarto.</p>
<p>Ran SQL queries to answer questions.</p>
<p>Generated a report in HTML format.</p>
<p>Files loader.qmd</p>
<p>report.qmd</p>
<p>report.html</p>
<p>Tools</p>
<p>Python</p>
<p>MySQL</p>
<p>Quarto</p>
</div>
</section>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>